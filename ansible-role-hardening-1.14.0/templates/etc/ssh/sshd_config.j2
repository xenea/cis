# {{ ansible_managed }}
{% if not crypto_policies_config or not set_crypto_policy %}

CASignatureAlgorithms {{ sshd_ca_signature_algorithms | replace(', ', ',') }}
Ciphers {{ sshd_ciphers | replace(', ', ',') }}
HostKeyAlgorithms {{ sshd_host_key_algorithms | replace(', ', ',') }}
KexAlgorithms {{ sshd_kex_algorithms | replace(', ', ',') }}
MACs {{ sshd_macs | replace(', ', ',') }}

{% endif %}
AcceptEnv {{ sshd_accept_env }}
AllowAgentForwarding {{ sshd_allow_agent_forwarding }}
AllowGroups {{ sshd_allow_groups }}
{% if sshd_allow_users is defined and sshd_allow_users %}
AllowUsers {{ sshd_allow_users }}
{% endif %}
AllowTcpForwarding {{ sshd_allow_tcp_forwarding }}
AuthenticationMethods {{ sshd_authentication_methods }}
Banner {{ sshd_banner }}
ChallengeResponseAuthentication {{ sshd_challenge_response_authentication }}
ClientAliveCountMax {{ sshd_client_alive_count_max | int }}
ClientAliveInterval {{ sshd_client_alive_interval | int }}
Compression {{ sshd_compression }}
GSSAPIAuthentication {{ sshd_gssapi_authentication }}
HostbasedAuthentication {{ sshd_hostbased_authentication }}
IgnoreRhosts {{ sshd_ignore_rhosts }}
IgnoreUserKnownHosts {{ sshd_ignore_user_known_hosts }}
KerberosAuthentication {{ sshd_kerberos_authentication }}
LogLevel {{ sshd_log_level }}
LoginGraceTime {{ sshd_login_grace_time | int }}
MaxAuthTries {{ sshd_max_auth_tries | int }}
MaxSessions {{ sshd_max_sessions | int }}
MaxStartups {{ sshd_max_startups }}
PasswordAuthentication {{ sshd_password_authentication }}
PermitEmptyPasswords {{ sshd_permit_empty_passwords }}
PermitRootLogin {{ sshd_permit_root_login }}
PermitUserEnvironment {{ sshd_permit_user_environment }}
Port {{ sshd_port|int }}
PrintLastLog {{ sshd_print_last_log }}
PrintMotd {{ sshd_print_motd }}
RekeyLimit {{ sshd_rekey_limit }}
{% if ssh_installed_version is version('9.1', '>') and (not crypto_policies_config or not set_crypto_policy) %}
RequiredRSASize {{ sshd_required_rsa_size }}
{% endif %}
StrictModes {{ sshd_strict_modes }}
Subsystem {{ sshd_subsystem }}
TCPKeepAlive {{ sshd_tcp_keep_alive }}
UseDNS {{ sshd_use_dns }}
UsePAM {{ sshd_use_pam }}
X11Forwarding {{ sshd_x11_forwarding }}
